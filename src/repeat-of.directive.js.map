{"version":3,"sources":["repeat-of.directive.ts"],"names":[],"mappings":"AAAA,OAAO,EAAA,SAAE,EAAU,KAAA,EAAkB,UAAA,EAAY,QAAA,EAAS,MAAM,eAAA,CAAgB;AAChF,OAAO,EAA2B,SAAA,EAAuC,aAAA,EAAc,MAAM,gBAAA,CAAiB;AAG9G,IAAM,KAAA,GAAY,IAAK,CAAC;AACxB,IAAM,IAAA,GAAO,cAAM,CAAA,CAAG;AAGtB;IAMI,2BAAoB,SAAmB;QAAnB,cAAS,GAAT,SAAS,CAAU;QAF/B,cAAS,GAAe,IAAI,CAAC;IAGrC,CAAC;IAGD,sBAAI,uCAAQ;aAAZ,UAAa,KAA+B;YACxC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,IAAI,CAAC,SAAS,EAAE,CAAC;YACjB,IAAI,CAAC,SAAS,EAAE,CAAC;QACrB,CAAC;;;OAAA;IAED,oCAAQ,GAAR,UAAS,OAAwB;QAC7B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,IAAI,OAAO,CAAC,KAAK,KAAK,EAAE,CAAC,CAAC,CAAC;YAChD,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;YACxC,MAAM,CAAC,KAAK,CAAC;QACjB,CAAC;QACD,MAAM,CAAC,EAAC,QAAQ,EAAE,oBAAoB,EAAC,CAAC;IAC5C,CAAC;IAED,qDAAyB,GAAzB,UAA0B,EAAc;QACpC,IAAI,CAAC,SAAS,GAAG,EAAE,IAAI,IAAI,CAAC;IAChC,CAAC;IAED,uCAAW,GAAX;QACI,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAEO,qCAAS,GAAjB;QACI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC;QACX,CAAC;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC;QACtD,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;QAE/C,EAAE,CAAC,CAAC,OAAO,IAAI,eAAe,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC,YAAY,CAAC,SAAS,CACzD,UAAA,KAAK,IAAI,OAAA,OAAO,CAAC,sBAAsB,EAAE,EAAhC,CAAgC,CAAC,CAAC;QACnD,CAAC;IACL,CAAC;IAEO,uCAAW,GAAnB;QACI,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;YACvB,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,CAAC;YACnC,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;QACrC,CAAC;IACL,CAAC;IAqBL,wBAAC;AAAD,CA9EA,AA8EC;;AAnBM,4BAAU,GAA0B;IAC3C,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;gBACtB,QAAQ,EAAE,YAAY;gBACtB,SAAS,EAAE;oBACP;wBACI,OAAO,EAAE,aAAa;wBACtB,WAAW,EAAE,UAAU,CAAC,cAAM,OAAA,iBAAiB,EAAjB,CAAiB,CAAC;wBAChD,KAAK,EAAE,IAAI;qBACd;iBACJ;aACJ,EAAG,EAAE;CACL,CAAC;AACF,kBAAkB;AACX,gCAAc,GAAmE,cAAM,OAAA;IAC9F,EAAC,IAAI,EAAE,QAAQ,GAAG;CACjB,EAF6F,CAE7F,CAAC;AACK,gCAAc,GAA2C;IAChE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;CAC7B,CAAC","file":"repeat-of.directive.js","sourceRoot":"","sourcesContent":["import {Directive, Input, OnDestroy, forwardRef, Injector} from \"@angular/core\";\nimport {AbstractControlDirective, NgControl, Validator, AbstractControl, NG_VALIDATORS} from \"@angular/forms\";\nimport {Subscription} from \"rxjs\";\n\nconst VALID: {} = null!;\nconst NOOP = () => {};\n\n\nexport class RepeatOfDirective implements Validator, OnDestroy {\n\n    private _repeatOf?: AbstractControlDirective;\n    private _repeatOfSubscr?: Subscription;\n    private _onChange: () => void = NOOP;\n\n    constructor(private _injector: Injector) {\n    }\n\n    \n    set repeatOf(value: AbstractControlDirective) {\n        this._repeatOf = value;\n        this.unsubscribe();\n        this.subscribe();\n        this._onChange();\n    }\n\n    validate(control: AbstractControl): {} {\n        if (!this._repeatOf) {\n            return VALID;\n        }\n        if (control.value == null || control.value === \"\") {\n            return VALID;\n        }\n        if (control.value == this._repeatOf.value) {\n            return VALID;\n        }\n        return {\"repeat\": \"Values don't match\"};\n    }\n\n    registerOnValidatorChange(fn: () => void): void {\n        this._onChange = fn || NOOP;\n    }\n\n    ngOnDestroy() {\n        this.unsubscribe();\n    }\n\n    private subscribe() {\n        if (!this._repeatOf) {\n            return;\n        }\n\n        const control = this._injector.get(NgControl).control;\n        const repeatOfControl = this._repeatOf.control;\n\n        if (control && repeatOfControl) {\n            this._repeatOfSubscr = repeatOfControl.valueChanges.subscribe(\n                value => control.updateValueAndValidity());\n        }\n    }\n\n    private unsubscribe() {\n        if (this._repeatOfSubscr) {\n            this._repeatOfSubscr.unsubscribe();\n            this._repeatOfSubscr = undefined;\n        }\n    }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n    selector: '[repeatOf]',\n    providers: [\n        {\n            provide: NG_VALIDATORS,\n            useExisting: forwardRef(() => RepeatOfDirective),\n            multi: true,\n        }\n    ],\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Injector, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'repeatOf': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}